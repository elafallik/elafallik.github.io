Based on Lagrange and some changes from andrewcharlesjones.github.io